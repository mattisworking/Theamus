function admin_add_extras(){var e=$('[name="addscript"]'),t=$('[name="addstyle"]');for(var n=0;n<e.length;n++){add_js_file(e[n].value);$(e[n]).remove()}for(var n=0;n<t.length;n++){add_css(t[n].value);$(t[n]).remove()}}function admin_window_run_on_load(e){if(typeof window[e]==="function"){return window[e]()}else{setTimeout(function(){admin_window_run_on_load(e)},100)}}function create_admin_window(e,t,n,r){if(!r)r="";var i=JSON.parse(localStorage.getItem("Theamus"));if($("#"+e).length>0){bring_admin_window_to_front($("#"+e).parentsUntil(".admin-windows"));return false}if(i["admin_open"]===true){$(".admin-header").addClass("admin-header-on");$(".admin-navigation").addClass("admin-navigation-"+admin_position);$(".admin-navigation").addClass("admin-navigation-open");if(Theamus.Mobile===false){if($(".admin-navigation").hasClass("admin-navigation-left")){$(".admin-navigation").addClass("admin-navigation-open-"+admin_position)}else{$(".admin-navigation").addClass("admin-navigation-open-"+admin_position)}}}var s=document.createElement("div");$(s).addClass("admin-window");r===""?$(s).addClass("admin-window-init"):$(s).attr("style",r);if(Theamus.Mobile===true){$(s).addClass("admin-window-mobile")}var o=document.createElement("div");$(o).addClass("window-chrome");$(o).html("<span class='title' title='"+t+"'>"+t+"</span>");$(o).append("<span class='close close-admin-window'><a href='#' title='Close Window'><span class='ion-close'></span></a></span>");$(o).append("<span class='refresh refresh-admin-window' data-url='"+n+"'><a href='#' title='Refresh Window'><span class='ion-refresh'></span></a></span>");$(s).append(o);var u=document.createElement("div");$(u).addClass("window-content");$(u).attr("id",e);$(s).append(u);var a=document.createElement("div");$(u).append(a);$(".admin-windows").append(s);setTimeout(function(){if(i["admin_open"]===true){$(s).addClass("admin-window-open")}admin_window_listeners();update_admin_window_content(e,n)},200);if(r===""){i["admin_cache"][e]=[t,n,""];localStorage.setItem("Theamus",JSON.stringify(i))}}function admin_window_loading(e){$("#"+e).children("div").html("<span class='spinner spinner-fixed admin-window-spinner'></span>")}function update_admin_window_content(e,t){$(".admin").addClass("admin-panel-open");$("#"+e).parentsUntil(".admin-windows").removeClass("admin-window-maxheight");bring_admin_window_to_front($("#"+e).parentsUntil(".admin-windows"));admin_window_loading(e);setTimeout(function(){Theamus.Ajax.run({url:Theamus.base_url+t,type:"include",result:$("#"+e).children("div"),after:function(){$("#"+e).parentsUntil(".admin-windows").find(".refresh").attr("data-url",t);admin_add_extras();resize_admin_window()}})},500);var n=JSON.parse(localStorage.getItem("Theamus"));if(n["admin_cache"][e]!==undefined){if(n["admin_cache"][e][1]!==t){n["admin_cache"][e][1]=t;localStorage.setItem("Theamus",JSON.stringify(n))}}}function resize_admin_window(){if(resize!==null)clearInterval(resize);for(var e=0;e<$(".admin-window").length;e++){var t=$(".admin-window")[e];if($(t).height()>$(window).height()&&Theamus.Mobile===false){$(t).addClass("admin-window-maxheight")}else if($(t).find(".window-content").children("div").height()<parseInt($(window).height()*.9-100)&&Theamus.Mobile===false){$(t).removeClass("admin-window-maxheight")}}resize=setInterval(function(){resize_admin_window()},500)}function change_admin_window_title(e,t){var n=$($("#"+e).siblings()[0]).children(".title");n.attr("title",t);n.html(t);var r=JSON.parse(localStorage.getItem("Theamus"));if(r["admin_cache"][e]!==undefined){if(r["admin_cache"][e][0]!==t){r["admin_cache"][e][0]=t;localStorage.setItem("Theamus",JSON.stringify(r))}}}function bring_admin_window_to_front(e){for(var t=0;t<$(".admin-window").length;t++){if($(".admin-window")[t]!==e){$($(".admin-window")[t]).css("z-index",false)}}$(e).css("z-index","10")}function admin_window_listeners(){if(Theamus.Mobile===false){$(".admin-window").draggable({handle:".window-chrome",cancel:".close",containment:"window",start:function(){bring_admin_window_to_front(this)},drag:function(){$(this).removeClass("admin-window-init")},stop:function(){var e=$(this).find(".window-content").attr("id"),t=JSON.parse(localStorage.getItem("Theamus"));if(t["admin_cache"][e]!==undefined){if(t["admin_cache"][e][2]!==$(this).attr("style")){t["admin_cache"][e][2]=$(this).attr("style");localStorage.setItem("Theamus",JSON.stringify(t))}}}})}$(".close-admin-window").click(function(e){e.preventDefault();var t=$(this);t.parentsUntil(".admin-windows").addClass("admin-window-closing");var n=t.parentsUntil(".admin-windows").find(".window-content").attr("id");var r=JSON.parse(localStorage.getItem("Theamus"));if(r["admin_cache"][n]!==undefined){delete r["admin_cache"][n];localStorage.setItem("Theamus",JSON.stringify(r))}setTimeout(function(){t.parentsUntil(".admin-windows").remove();if($(".admin-window").length===0){$(".admin").removeClass("admin-panel-open")}},1e3)});$(".refresh-admin-window").click(function(e){e.preventDefault();var t=$($(this).parent().siblings(".window-content")[0]).attr("id");update_admin_window_content(t,$(this).attr("data-url"))});$(".admin-window").click(function(e){bring_admin_window_to_front(this)})}function switch_position_text(){$('[name="admin-move"]').html(admin_position==="left"?">>>":"<<<")}$(document).ready(function(){if(localStorage.getItem("Theamus")===null){localStorage.setItem("Theamus",JSON.stringify({admin_position:"left",admin_cache:{1:0},admin_open:false}))}var e=JSON.parse(localStorage.getItem("Theamus"));admin_position=e["admin_position"];if(admin_position!=="left"&&admin_position!=="right"){e["admin_position"]="left";localStorage.setItem("Theamus",JSON.stringify(e))}$(".admin-header").addClass("admin-header-"+admin_position);$(".admin-navigation").addClass("admin-navigation-"+admin_position);resize=null;add_css("themes/admin/style/css/admin.css");if(Theamus.Mobile===true){$(".admin").addClass("admin-mobile")}$("#ad_open-nav").click(function(e){e.preventDefault();var t=false;$(".admin-navigation").toggleClass("admin-navigation-open");if($(".admin-navigation").hasClass("admin-navigation-"+admin_position)){$(".admin-navigation").toggleClass("admin-navigation-open-"+admin_position)}else{$(".admin-navigation").toggleClass("admin-navigation-open-"+admin_position)}if($(".admin-navigation").hasClass("admin-navigation-open")){$(".admin-header").addClass("admin-header-on");$(".admin").addClass("admin-panel-open");for(var n=0;n<$(".admin-window").length;n++){$($(".admin-window")[n]).addClass("admin-window-open")}t=true}else{$(".admin-header").removeClass("admin-header-on");$(".admin").removeClass("admin-panel-open");for(var n=0;n<$(".admin-window").length;n++){$($(".admin-window")[n]).removeClass("admin-window-open")}t=false}var r=JSON.parse(localStorage.getItem("Theamus"));r["admin_open"]=t;localStorage.setItem("Theamus",JSON.stringify(r))});$('[name="admin-nav-item"]').click(function(e){e.preventDefault();if(Theamus.Mobile===true){$(".admin-navigation").removeClass("admin-navigation-open");$(".admin-navigation").removeClass("admin-navigation-open-left");$(".admin-navigation").removeClass("admin-navigation-open-right")}var t=$(this).attr("data-title"),n=$(this).attr("data-id"),r=$(this).attr("data-url");create_admin_window(n,t,r);for(var i=0;i<$(".admin-window").length;i++){if(Theamus.Mobile===false){var s=$($(".admin-window")[i]).position(),o=200+20*i,u=10+20*i;if(s.left===o&&s.top===u){$("#"+n).parentsUntil(".admin-windows").css({left:o+20+"px",top:u+20+"px"})}}}});$('[name="admin-move"]').click(function(t){t.preventDefault();$(".admin-header").removeClass("admin-header-"+admin_position);$(".admin-navigation").removeClass("admin-navigation-"+admin_position);$(".admin-navigation").removeClass("admin-navigation-open-"+admin_position);var n=admin_position==="left"?"right":"left";$(".admin-header").addClass("admin-header-"+n);$(".admin-navigation").addClass("admin-navigation-"+n);$(".admin-navigation").addClass("admin-navigation-open-"+n);e["admin_position"]=n;localStorage.setItem("Theamus",JSON.stringify(e));admin_position=n;switch_position_text()});switch_position_text();setTimeout(function(){$(".admin").removeAttr("style");$(".admin").addClass("admin-on")},200);if(e["admin_cache"]!==undefined&&Theamus.Mobile===false){for(var t in e["admin_cache"]){if(t==="1")continue;create_admin_window(t,e["admin_cache"][t][0],e["admin_cache"][t][1],e["admin_cache"][t][2])}}})