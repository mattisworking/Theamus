function admin_add_extras(){for(var n=$('[name="addscript"]'),i=$('[name="addstyle"]'),a=0;a<n.length;a++)add_js_file(n[a].value),$(n[a]).remove();for(var a=0;a<i.length;a++)add_css(i[a].value),$(i[a]).remove()}function get_window_function(n){if(void 0===window)return 0;if(void 0===n)return 0;if(n.indexOf(".")>0){for(var i=n.split("."),a=window,e=0;e<i.length;e++){if(void 0===a[i[e]])return 0;a=a[i[e]]}return a}return"function"==typeof window[n]?window[n]:0}function admin_window_run_on_load(n){var i=get_window_function(n);return"function"==typeof i?i():void setTimeout(function(){admin_window_run_on_load(n)},100)}function create_admin_window(n,i,a,e){e||(e="");var d=JSON.parse(localStorage.getItem("Theamus"));if($("#"+n).length>0)return bring_admin_window_to_front($("#"+n).parentsUntil(".admin-windows")),!1;d.admin_open===!0&&($(".admin-header").addClass("admin-header-on"),$(".admin-navigation").addClass("admin-navigation-"+admin_position),$(".admin-navigation").addClass("admin-navigation-open"),Theamus.Mobile===!1&&$(".admin-navigation").addClass($(".admin-navigation").hasClass("admin-navigation-left")?"admin-navigation-open-"+admin_position:"admin-navigation-open-"+admin_position));var t=document.createElement("div");$(t).addClass("admin-window"),""===e?$(t).addClass("admin-window-init"):$(t).attr("style",e),Theamus.Mobile===!0&&$(t).addClass("admin-window-mobile");var o=document.createElement("div");$(o).addClass("window-chrome"),$(o).html("<span class='title' title='"+i+"'>"+i+"</span>"),$(o).append("<span class='close close-admin-window'><a href='#' title='Close Window'><span class='ion-close'></span></a></span>"),$(o).append("<span class='refresh refresh-admin-window' data-url='"+a+"'><a href='#' title='Refresh Window'><span class='ion-refresh'></span></a></span>"),$(t).append(o);var s=document.createElement("div");$(s).addClass("window-content"),$(s).attr("id",n),$(t).append(s);var m=document.createElement("div");$(s).append(m),$(".admin-windows").append(t),setTimeout(function(){d.admin_open===!0&&$(t).addClass("admin-window-open"),admin_window_listeners(),update_admin_window_content(n,a)},200),""===e&&(d.admin_cache[n]=[i,a,""],localStorage.setItem("Theamus",JSON.stringify(d)))}function admin_window_loading(n){$("#"+n).children("div").html("<span class='spinner spinner-fixed admin-window-spinner'></span>")}function update_admin_window_content(n,i){$(".admin").addClass("admin-panel-open"),$("#"+n).parentsUntil(".admin-windows").removeClass("admin-window-maxheight"),bring_admin_window_to_front($("#"+n).parentsUntil(".admin-windows")),admin_window_loading(n),setTimeout(function(){Theamus.Ajax.run({url:Theamus.base_url+i,type:"include",result:$("#"+n).children("div"),after:function(){$("#"+n).parentsUntil(".admin-windows").find(".refresh").attr("data-url",i),admin_add_extras(),resize_admin_window()}})},500);var a=JSON.parse(localStorage.getItem("Theamus"));void 0!==a.admin_cache[n]&&a.admin_cache[n][1]!==i&&(a.admin_cache[n][1]=i,localStorage.setItem("Theamus",JSON.stringify(a)))}function resize_admin_window(){null!==resize&&clearInterval(resize);for(var n=0;n<$(".admin-window").length;n++){var i=$(".admin-window")[n];$(i).height()>$(window).height()&&Theamus.Mobile===!1?$(i).addClass("admin-window-maxheight"):$(i).find(".window-content").children("div").height()<parseInt(.9*$(window).height()-100)&&Theamus.Mobile===!1&&$(i).removeClass("admin-window-maxheight")}resize=setInterval(function(){resize_admin_window()},500)}function change_admin_window_title(n,i){var a=$($("#"+n).siblings()[0]).children(".title");a.attr("title",i),a.html(i);var e=JSON.parse(localStorage.getItem("Theamus"));void 0!==e.admin_cache[n]&&e.admin_cache[n][0]!==i&&(e.admin_cache[n][0]=i,localStorage.setItem("Theamus",JSON.stringify(e)))}function bring_admin_window_to_front(n){for(var i=0;i<$(".admin-window").length;i++)$(".admin-window")[i]!==n&&$($(".admin-window")[i]).css("z-index",!1);$(n).css("z-index","10")}function admin_window_listeners(){Theamus.Mobile===!1&&$(".admin-window").draggable({handle:".window-chrome",cancel:".close",containment:"window",start:function(){bring_admin_window_to_front(this)},drag:function(){$(this).removeClass("admin-window-init")},stop:function(){var n=$(this).find(".window-content").attr("id"),i=JSON.parse(localStorage.getItem("Theamus"));void 0!==i.admin_cache[n]&&i.admin_cache[n][2]!==$(this).attr("style")&&(i.admin_cache[n][2]=$(this).attr("style"),localStorage.setItem("Theamus",JSON.stringify(i)))}}),$(".close-admin-window").click(function(n){n.preventDefault();var i=$(this);i.parentsUntil(".admin-windows").addClass("admin-window-closing");var a=i.parentsUntil(".admin-windows").find(".window-content").attr("id"),e=JSON.parse(localStorage.getItem("Theamus"));void 0!==e.admin_cache[a]&&(delete e.admin_cache[a],localStorage.setItem("Theamus",JSON.stringify(e))),setTimeout(function(){i.parentsUntil(".admin-windows").remove(),0===$(".admin-window").length&&$(".admin").removeClass("admin-panel-open")},1e3)}),$(".refresh-admin-window").click(function(n){n.preventDefault();var i=$($(this).parent().siblings(".window-content")[0]).attr("id");update_admin_window_content(i,$(this).attr("data-url"))}),$(".admin-window").click(function(){bring_admin_window_to_front(this)})}function switch_position_text(){$('[name="admin-move"]').html("left"===admin_position?">>>":"<<<")}$(document).ready(function(){null===localStorage.getItem("Theamus")&&localStorage.setItem("Theamus",JSON.stringify({admin_position:"left",admin_cache:{1:0},admin_open:!1}));var n=JSON.parse(localStorage.getItem("Theamus"));if(admin_position=n.admin_position,"left"!==admin_position&&"right"!==admin_position&&(n.admin_position="left",localStorage.setItem("Theamus",JSON.stringify(n))),$(".admin-header").addClass("admin-header-"+admin_position),$(".admin-navigation").addClass("admin-navigation-"+admin_position),resize=null,add_css("themes/admin/style/css/admin.css"),Theamus.Mobile===!0&&$(".admin").addClass("admin-mobile"),$("#ad_open-nav").click(function(n){n.preventDefault();var i=!1;if($(".admin-navigation").toggleClass("admin-navigation-open"),$(".admin-navigation").toggleClass($(".admin-navigation").hasClass("admin-navigation-"+admin_position)?"admin-navigation-open-"+admin_position:"admin-navigation-open-"+admin_position),$(".admin-navigation").hasClass("admin-navigation-open")){$(".admin-header").addClass("admin-header-on"),$(".admin").addClass("admin-panel-open");for(var a=0;a<$(".admin-window").length;a++)$($(".admin-window")[a]).addClass("admin-window-open");i=!0}else{$(".admin-header").removeClass("admin-header-on"),$(".admin").removeClass("admin-panel-open");for(var a=0;a<$(".admin-window").length;a++)$($(".admin-window")[a]).removeClass("admin-window-open");i=!1}var e=JSON.parse(localStorage.getItem("Theamus"));e.admin_open=i,localStorage.setItem("Theamus",JSON.stringify(e))}),$('[name="admin-nav-item"]').click(function(n){n.preventDefault(),Theamus.Mobile===!0&&($(".admin-navigation").removeClass("admin-navigation-open"),$(".admin-navigation").removeClass("admin-navigation-open-left"),$(".admin-navigation").removeClass("admin-navigation-open-right"));var i=$(this).attr("data-title"),a=$(this).attr("data-id"),e=$(this).attr("data-url");create_admin_window(a,i,e);for(var d=0;d<$(".admin-window").length;d++)if(Theamus.Mobile===!1){var t=$($(".admin-window")[d]).position(),o=200+20*d,s=10+20*d;t.left===o&&t.top===s&&$("#"+a).parentsUntil(".admin-windows").css({left:o+20+"px",top:s+20+"px"})}}),$('[name="admin-move"]').click(function(i){i.preventDefault(),$(".admin-header").removeClass("admin-header-"+admin_position),$(".admin-navigation").removeClass("admin-navigation-"+admin_position),$(".admin-navigation").removeClass("admin-navigation-open-"+admin_position);var a="left"===admin_position?"right":"left";$(".admin-header").addClass("admin-header-"+a),$(".admin-navigation").addClass("admin-navigation-"+a),$(".admin-navigation").addClass("admin-navigation-open-"+a),n.admin_position=a,localStorage.setItem("Theamus",JSON.stringify(n)),admin_position=a,switch_position_text()}),switch_position_text(),setTimeout(function(){$(".admin").removeAttr("style"),$(".admin").addClass("admin-on")},200),void 0!==n.admin_cache&&Theamus.Mobile===!1)for(var i in n.admin_cache)"1"!==i&&create_admin_window(i,n.admin_cache[i][0],n.admin_cache[i][1],n.admin_cache[i][2])});