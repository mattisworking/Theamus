/*
 * classList.js: Cross-browser full element.classList implementation.
 * 2012-11-15
 *
 * By Eli Grey, http://eligrey.com
 * Public Domain.
 * NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.
 */
if(typeof document!=="undefined"&&!("classList"in document.documentElement)){(function(e){"use strict";if(!("HTMLElement"in e)&&!("Element"in e))return;var t="classList",n="prototype",r=(e.HTMLElement||e.Element)[n],i=Object,s=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++){if(t in this&&this[t]===e){return t}}return-1},u=function(e,t){this.name=e;this.code=DOMException[e];this.message=t},a=function(e,t){if(t===""){throw new u("SYNTAX_ERR","An invalid or illegal string was specified")}if(/\s/.test(t)){throw new u("INVALID_CHARACTER_ERR","String contains an invalid character")}return o.call(e,t)},f=function(e){var t=s.call(e.className),n=t?t.split(/\s+/):[],r=0,i=n.length;for(;r<i;r++){this.push(n[r])}this._updateClassName=function(){e.className=this.toString()}},l=f[n]=[],c=function(){return new f(this)};u[n]=Error[n];l.item=function(e){return this[e]||null};l.contains=function(e){e+="";return a(this,e)!==-1};l.add=function(){var e=arguments,t=0,n=e.length,r,i=false;do{r=e[t]+"";if(a(this,r)===-1){this.push(r);i=true}}while(++t<n);if(i){this._updateClassName()}};l.remove=function(){var e=arguments,t=0,n=e.length,r,i=false;do{r=e[t]+"";var s=a(this,r);if(s!==-1){this.splice(s,1);i=true}}while(++t<n);if(i){this._updateClassName()}};l.toggle=function(e,t){e+="";var n=this.contains(e),r=n?t!==true&&"remove":t!==false&&"add";if(r){this[r](e)}return!n};l.toString=function(){return this.join(" ")};if(i.defineProperty){var h={get:c,enumerable:true,configurable:true};try{i.defineProperty(r,t,h)}catch(p){if(p.number===-2146823252){h.enumerable=false;i.defineProperty(r,t,h)}}}else if(i[n].__defineGetter__){r.__defineGetter__(t,c)}})(self)}

// Theamus AJAX
var ajax=new function(){this.fail=false;this.has_file=false;this.hideable=false;this.allow_file_upload=true;this.run=function(e){this.allow_file_upload=true;var t,n;t=this.get_form_data(e);t=this.get_extra_fields(e,t);t=this.add_ajax_type(e,t);t=this.add_file_object(e,t);t=this.get_ajax_hash(t);t=this.get_location(t);n=this.sanitize_url(e);if(this.fail===false){$.ajax({type:"POST",url:n,data:t,processData:this.processData,contentType:this.contentType,xhr:function(){var t=new XMLHttpRequest;if(window.FormData!==undefined){t.upload.addEventListener("progress",function(t){ajax.show_upload(t,e)},false)}return t},success:function(t){ajax.hide_upload(e);ajax.show_results(e,t);ajax.run_after(e);ajax.run_return_functions();add_extras()},error:function(e,t,n){console.log("AJAX Error: "+n)}})}else{console.log("AJAX Setup Error: "+this.fail)}return false};this.get_form_data=function(e){var t,n,r,i;if("form"in e){t=$("#"+e.form);if(t.length>0){n=this.get_form_elements(e.form);r=this.get_element_values(n);i=this.make_form_data(r)}else{i=this.form_data()}}else{i=this.form_data()}return i};this.form_data=function(){if(window.FormData===undefined){this.processData=true;this.contentType="application/x-www-form-urlencoded";return{}}else{var e=new FormData;this.processData=false;this.contentType=false;return e}};this.form_data_append=function(e,t,n){if(window.FormData===undefined){e[t]=n}else{e.append(t,n)}return e};this.get_form_elements=function(e){var t=typeof e==="object"?$(e).find(":input"):$("#"+e+" :input");return t};this.reset_form_elements=function(e,t){var n=this.get_form_elements(e);t=t!==undefined?t:new Array;for(var r=0;r<n.length;r++){if(t.indexOf(n[r].name)===-1){if(n[r].type!=="button"&&n[r].type!=="submit"){n[r].value=""}}}};this.get_id_elements=function(e){var t=new Array;for(var n=0;n<e.length;n++){t.push($("#"+e[n])[0])}return t};this.get_element_values=function(e,t){var n,r,i;n=new Array;if(t===undefined||t===null)t=false;for(var s=0;s<e.length;s++){r=e[s];if(r===undefined||r===null){this.fail="Failed to gather an element.";break}if(r.type==="checkbox"){i=r.checked===true?"true":"false"}else if(r.type==="file"&&window.FormData!==undefined){if(r.files.length>0&&this.allow_file_upload===true){if(r.files.length>=1){i=r.files[0];this.has_file=true}else{i="false";this.has_file=false}}else{i="false";this.has_file=false}}else if(r.type==="radio"){var o=$("[name='"+r.name+"']");for(var u=0;u<o.length;u++){if(o[u].checked){i=o[u].value;break}}}else if(r.tagName.toLowerCase()==="select"){if(r.getAttribute("multiple")==="multiple"){var a,f;a=r.options;f=new Array;for(var l=0;l<a.length;l++){if(a[l].selected===true){f.push(a[l].value)}}i=f.join(",")}else{i=r.value}}else if(r.tagName.toLowerCase()==="div"){i=r.innerHTML}else{i=r.value}if(t===false){if(r.name===undefined){n[r.id]=i}else{n[r.name]=i}}else{n.push(i)}}return n};this.make_form_data=function(e,t){if(t===undefined||t===null){t=this.form_data()}var n;for(key in e){if(typeof e[key]==="object"){n=e[key]}else{n=encodeURIComponent(e[key])}t=this.form_data_append(t,key,n)}return t};this.get_extra_fields=function(e,t){var n,r,i;if("extra_fields"in e){n=e.extra_fields;if($.isArray(n)===false){n=new Array;n.push(e.extra_fields)}r=this.get_id_elements(n);i=this.get_element_values(r);t=this.make_form_data(i,t);return t}else{return t}};this.format_bytes=function(e){var t=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,t)).toFixed(2)*1+" "+["B","kB","MB","GB","TB"][t]};this.get_ajax_hash=function(e){var t=false;if(e===undefined)t=true;var n=document.getElementById("ajax-hash-data");if(n===undefined){if(t===true)this.api_fail="Unable to make AJAX request.";else this.fail="Unable to make AJAX request."}else{if(t===true)return n.value;else{e=this.form_data_append(e,"ajax-hash-data",n.value);return e}}};this.get_location=function(e){if($(".admin").length===0||!$(".admin").hasClass("admin-panel-open")){e=this.form_data_append(e,"location","site")}else{e=this.form_data_append(e,"location","admin")}return e};this.sanitize_url=function(e){var t,n;if("url"in e){t=e.url.slice(-1)!=="/"?"":"";n=e.url+t;return n}else{this.fail="There is no URL to go to."}};this.add_ajax_type=function(e,t){var n="type"in e?e.type:"script";t=this.form_data_append(t,"ajax",n);return t};this.get_result_area=function(e){if("result"in e){if($("#"+e.result).length>0){return $("#"+e.result)}else{this.fail="The AJAX result div provided doesn't exist."}}else{this.fail="There is nowhere to put the AJAX results."}};this.show_upload=function(e,t){var n,r;var i="upload-progress";var s="upload-percentage";var o=5;var u=true;if("upload"in t){i="growbar"in t.upload?t.upload.growbar:i;s="percentage"in t.upload?t.upload.percentage:s;o="stop"in t.upload?t.upload.stop:o;u="show"in t.upload?t.upload.show:u}if($("#"+i).length<1)u=false;if($("#"+s).length<1)r=false;if(e.lengthComputable){if($("#"+i).length>0){if($("#"+i)[0].style.display!=="block"){$("#"+i).show()}}var a=ajax.get_upload_data(e);n=a.completed;if(u===true&&this.has_file!==false){$("#"+i).show();$("#"+i)[0].style.width=n*o+"px";if(r!==false)$("#"+s).html(n+"%");this.hideable=true;this.stop=o}return n}};this.get_upload_data=function(e){var t=0;if(e.lengthComputable){t=Math.floor(e.loaded/e.total*100)}var n={percent_completed:t,percentage:t+"%",loaded:e.loaded,loaded_formatted:this.format_bytes(e.loaded),total_bytes:e.totalSize,total_bytes_formatted:this.format_bytes(e.totalSize),time_micro:e.timeStamp,time_formatted:new Date(e.timeStamp)};return n};this.hide_upload=function(e){if(this.hideable===true){if("upload"in e){var t="hide"in e.upload?e.upload.hide:true;var n="hide_time"in e.upload?e.upload.hide_time:3;n=n*1e3;var r="growbar"in e.upload?e.upload.growbar:"upload-progress";var i="percentage"in e.upload?e.upload.percentage:"upload-percentage";$("#"+r)[0].style.width=100*this.stop+"px";$("#"+i).html("100%");if(t===true){setTimeout(function(){$("#"+r).hide()},n)}}}};this.run_after=function(e){var t,n;if("after"in e){if(typeof e.after==="function")e.after();else if("do_function"in e.after){t=e.after.do_function;if(typeof t==="string"){n="arguments"in e.after?e.after.arguments:"";window[t](n)}else{for(var r=0;r<t.length;r++){n="arguments"in e.after?e.after.arguments[r]:"";window[t[r]](n)}}}}};this.run_return_functions=function(){var e,t,n;var r=$("[name='run_after']");if(r.length>0){for(var i=0;i<r.length;i++){e=r[i].getAttribute("function");t=r[i].getAttribute("arguments");if(t!=="")t=$.parseJSON(t);window[e](t);r[i].remove()}}};this.show_results=function(e,t){var n=this.get_result_area(e);if(n!==undefined){n.show();n.html(t);if("hide_result"in e){setTimeout(function(){n.hide()},e.hide_result*1e3)}}else{console.log(this.fail)}};this.add_file_object=function(e,t){if("file_object"in e){t=this.form_data_append(t,"file",e.file_object);this.has_file=true}return t};this.api=function(e){api_return=false;this.allow_file_upload=true;this.api_fail=false;var t=this.check_api_args(e);t.url=this.sanitize_url(t);t.data=this.make_api_data(t);t.form_data=t.type==="post"?this.make_form_data(t.data):t.data;if(t.type==="get"){this.processData=true;this.contentType="application/x-www-form-urlencoded; charset=UTF-8"}this.api_fail=this.api_fail_response();if(this.api_fail!==false){if(typeof t.success!=="function"){console.log("Theamus API error: "+this.api_fail.error.message)}else{t.success(this.api_fail)}}if(this.api_fail===false){$.ajax({async:false,type:t.type,url:t.url,data:t.form_data,processData:this.processData,contentType:this.contentType,xhr:function(){var t=new XMLHttpRequest;if(window.FormData!==undefined){t.upload.addEventListener("progress",function(t){if("upload"in e&&"during"in e.upload){if(typeof e.upload.during==="function"){e.upload.during(ajax.get_upload_data(t))}}},false)}return t},success:function(e,n,r){try{var e=JSON.parse(e);e.response.headers=r.getAllResponseHeaders();e.response.text=n;e.response.status=r.status}catch(i){e={error:{status:1,message:"Failed to decode API return data."},response:{headers:e.getAllResponseHeaders,text:n,status:e.status,data:e}}}api_return=t.success(e)}})}return api_return};this.check_api_args=function(e){var t={ajax:"api",hash:this.get_ajax_hash()};if(typeof e!=="object"){this.api_fail="API arguments are not valid.";e={url:"",method:""};return e}if("type"in e&&typeof e.type==="string"){if(e.type!=="post"&&e.type!=="get"){this.api_fail="API request type must be 'post' or 'get'."}else{t.type=e.type.toLowerCase()}if(e.type==="get"){this.allow_file_upload=false}}else{this.api_fail="Invalid API request type."}if("url"in e&&typeof e.url==="string"){t.url=e.url}else{this.api_fail="Invalid API url."}if("method"in e){t.method_class="";if(typeof e.method==="string"){t.method=e.method}else if(typeof e.method==="object"){if(e.method.length>=1){t.method_class=e.method[0]}else{this.api_fail="Undefined API method."}if(e.method.length>=2){t.method=e.method[1]}else{this.api_fail="Undefined API method after finding class."}}else{this.api_fail="Invalid API method defined."}}else{this.api_fail="API method not defined."}if("data"in e){if("form"in e.data){if(typeof e.data.form==="object"){t.data_form=e.data.form}else{this.api_fail="Invalid API form selector."}}if("custom"in e.data){if(typeof e.data.custom==="object"){t.data_custom=e.data.custom}else{this.api_fail="Invalid API custom data type."}}if("elements"in e.data){if(typeof e.data.elements==="object"){t.data_elements=e.data.elements}else{this.api_fail="Invalid API elements data type."}}}if("success"in e){if(typeof e.success==="function"){t.success=e.success}else{this.api_fail="API success must be a function."}}else{this.api_fail="Undefined 'success' function to run."}return t};this.api_fail_response=function(){if(this.api_fail!==false){return{error:{status:1,message:this.api_fail},response:{status:0,data:"",text:""}}}return false};this.make_api_data=function(e){var t={method_class:e.method_class,method:e.method,ajax:e.ajax,"ajax-hash-data":e.hash,"api-from":"javascript"};var n=this.get_form_elements(e.data_form),r=this.get_element_values(n);for(var i in r)t[i]=r[i];for(var i in e.data_custom){if(t[i]!==undefined){this.api_fail="Multiple data key detected. Conflicted key = '"+i+"'.";break}else{t[i]=e.data_custom[i]}}if(e.data_elements!==undefined){for(var s=0;s<e.data_elements.length;s++){if(e.data_elements[s].length>1){this.api_fail="Multiple custom elements detected where there should be one.";break}else{var o=$(e.data_elements[s]),i="";if(o.attr("id")!==undefined){i=o.attr("id")}if(i===""&&o.attr("name")!==undefined){i=o.attr("name")}if(i===""){this.api_fail="Element has no identifiable name or id.";break}else if(t[i]!==undefined){this.api_fail="Multiple data key detected.  Conflicted key = '"+i+"'."}else{t[i]=this.get_element_values(e.data_elements[s],true)[0]}}}}return t};this.iterate_calls=function(e,t,n){var r=t,t=t!==undefined?parseInt(t)*1e3:0,n=n!==undefined?n:0,i=function(){};if(e===undefined){console.log("Iterate calls error: Functions not defined.");return}if(e[n]!==undefined){setTimeout(function(){i=typeof e[n]==="function"?e[n]:window[e[n]];if(i()!==false){ajax.iterate_calls(e,r,n+1)}},t)}return}}

// Theamus WYSIWYG Editor
var editor=new function(){this.executables=function(){this.exec={bold:{"do":function(){editor.document_exec({"do":"bold"})}},underline:{"do":function(){editor.document_exec({"do":"underline"})}},italicize:{"do":function(){editor.document_exec({"do":"italic"})}},unorderedlist:{"do":function(){editor.document_exec({"do":"insertunorderedlist"})}},orderedlist:{"do":function(){editor.document_exec({"do":"insertorderedlist"})}},indent:{"do":function(){editor.document_exec({"do":"indent"})}},outdent:{"do":function(){editor.document_exec({"do":"outdent"})}},alignleft:{"do":function(){editor.document_exec({"do":"justifyLeft"})}},aligncenter:{"do":function(){editor.document_exec({"do":"justifyCenter"})}},alignright:{"do":function(){editor.document_exec({"do":"justifyRight"})}},alignfull:{"do":function(){editor.document_exec({"do":"justifyFull"})}},fontsize:{"do":function(){editor.change_font_size()}},togglecode:{"do":function(){editor.toggle_code()}},addcodeblock:{"do":function(){editor.add_code_block()}},addlink:{"do":function(){editor.add_link_window()}},addimage:{"do":function(){editor.add_image_window()}},showmore:{"do":function(){editor.toggle_sink()}}}};this.set_options=function(e){if(!e)e={};editor.el_id="id"in e?e.id:"editor";editor.el=document.getElementById(editor.el_id);editor.width="width"in e&&e.width!=="auto"?e.width:"500px";editor.code_id=editor.el_id+"-code";editor.code_el=document.getElementById(editor.code_id);editor.wrapper_id="editor_wrapper";editor.wrapper=document.getElementById(editor.wrapper_id);editor.breadcrumb_id="editor_breadcrumbs";editor.breadcrumb_el=document.getElementById(editor.breadcrumb_id);editor.window_wrapper_id="editor_window-wrapper";editor.window_wrapper=document.getElementById(editor.window_wrapper_id);editor.link_info_wrapper_id="editor_link-info-wrapper";editor.link_info_wrapper=document.getElementById(editor.link_info_wrapper_id);editor.sink_id="editor_sink-wrapper";editor.sink=document.getElementById(editor.sink_id);editor.codemirror=false;if(typeof CodeMirror!=="undefined"){if(CodeMirror.xml_loaded===undefined){var t="system/editor/js/codemirror/mode/xml/xml.js?x="+editor.load_time,n="system/editor/js/codemirror/mode/javascript/javascript.js?x="+editor.load_time,r="system/editor/js/codemirror/mode/css/css.js?x="+editor.load_time,i="system/editor/js/codemirror/mode/htmlmixed/htmlmixed.js?x="+editor.load_time;if(check_js_file(t)===true)add_js_file(t);if(check_js_file(n)===true)add_js_file(n);if(check_js_file(r)===true)add_js_file(r);if(check_js_file(i)===true)add_js_file(i);add_css("system/editor/css/codemirror.css?x="+editor.load_time)}}};this.initialize=function(e){if(editor.load_time===undefined)editor.load_time=(new Date).getTime();var t=editor.test_load();editor.set_options(e);if(!t){setTimeout(function(){editor.initialize(e)},500)}else{if(navigator.appVersion.indexOf("MSIE 8.0")===-1){editor.load_listeners();editor.set_listeners()}else editor.fallback()}};this.fallback=function(){var e=document.createElement("textarea");e.setAttribute("id",editor.el_id);e.setAttribute("class","editor_fancy-input");e.style.width=editor.width;editor.wrapper.parentNode.replaceChild(e,editor.wrapper)};this.test_load=function(){var e=[],t="system/editor/js/codemirror/codemirror.js?x="+editor.load_time;if(check_js_file(t)===false){if(typeof CodeMirror==="undefined")e.push(false);if(CodeMirror.xml_loaded===undefined)e.push(false);else e.push(true)}else{add_js_file(t);e.push(false)}if(editor.el_id!=="undefined")e.push(true);else e.push(false);if(e.indexOf(false)===-1)return true;else return false};this.parents=function(e,t){var n=[],r;if(e&&e.element)r=e.element;else r=e?e.parentNode:e;while(r!==null&&r!==undefined){if(r===t)break;n.push(r);r=r.parentNode}return n};this.dataset=function(e,t,n){var r="data-"+t;if(n)e.setAttribute(r,n);else{if(e.getAttribute(r)!==undefined)return e.getAttribute(r);else return""}};this.toggle_disable=function(e){var t=document.getElementById(e);if(t.getAttribute("disabled")===null)t.setAttribute("disabled","disabled");else t.removeAttribute("disabled")};this.br2nl=function(e){return e.replace(/<br>/g,"\r")};this.nl2br=function(e){return e.replace(/(\r\n|\n\r|\r|\n)/g,"<br/>")};this.load_listeners=function(){this.listeners=[];this.executables();this.execute_listeners();this.load_code()};this.set_listeners=function(){this.toggle_editable();this.plain_paste();this.get_breadcrumbs();this.modify_return();this.modify_tab();this.add_tail();this.update_code();this.link_information();this.edit_img_listeners()};this.center_window=function(e){var t=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)/2,n=(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)/2,r=e.offsetWidth/2,i=e.offsetHeight/2;e.style.position="fixed";e.style.left=t-r+"px";e.style.top=n-i+"px"};this.editor_interact=function(e){if(!e)e={};e.element="element"in e?e.element:editor.el;e.action="action"in e?e.action:"click";e.on="on"in e?e.on:function(){};e.off="off"in e?e.off:function(){};e["do"]="do"in e?e["do"]:function(){};if(e.action instanceof Array){for(var t=0;t<e.action.length;t++){this.add_event_listener({element:e.element,action:e.action[t],on:e.on,off:e.off,"do":e["do"]})}}else this.add_event_listener(e)};this.add_event_listener=function(e){if(e.element!==undefined){if(e.element.addEventListener){e.element.addEventListener(e.action,function(t){var n=editor.parents(t.srcElement);e["do"](t)},false)}else{if(e.action==="click")e.action="onclick";if(e.action==="keyup")e.action="onkeyup";e.element.attachEvent(e.action,function(t){e["do"](t)})}}};this.insert_at_caret=function(e){editor.el.focus();rangy.deserializeSelection(editor.range);var t=rangy.getSelection().getRangeAt(0);t.insertNode(e)};this.with_selection=function(e){if(!e)e={};e["do"]="do"in e?e["do"]:function(){};e.fallback="fallback"in e?e.fallback:function(){};var t,n;rsel=rangy.getSelection();t=rsel.isCollapsed===true?false:rsel;e["do"](t)};this.toggle_editable=function(){this.editor_interact({action:"click","do":function(e){var t=e.target||e.srcElement;if(t.tagName==="SELECT")return false;if(t.tagName==="TEXTAREA")return false;editor.el.setAttribute("contenteditable",true);document.body.style.overflowX="hidden";editor.el.focus()}})};this.get_breadcrumbs=function(){this.editor_interact({action:["keyup","click"],"do":function(e){var t=rangy.getSelection().focusNode,n=editor.parents(t,editor.wrapper),r=[],i=[];for(var s=0;s<n.length;s++){if(n[s].tagName==="FORM")break;if(n[s].tagName){i.push(n[s]);r.push(n[s].tagName.toLowerCase())}}editor.breadcrumbs=r;editor.show_breadcrumbs(r);editor.set_current_formats(r,i)}})};this.modify_tab=function(){this.editor_interact({action:"keydown","do":function(e){if(e.keyCode===9){e.preventDefault();if(window.getSelection){var t=window.getSelection();if(t.getRangeAt&&t.rangeCount)var n=t.getRangeAt(0)}var r=document.createTextNode("    ");n.insertNode(r);n.collapse(false);var t=window.getSelection();t.removeAllRanges();t.addRange(n)}}})};this.modify_return=function(){this.editor_interact({action:"keydown","do":function(e){var t=editor.breadcrumbs?editor.breadcrumbs.reverse()[0]:"",n=["li","ol","ul"];if(e.which===13&&n.indexOf(t)===-1&&document.activeElement!==editor.code_el){if(e.preventDefault)e.preventDefault();else e.returnValue=false;editor.with_selection({"do":function(e){var e=rangy.getSelection();var t=e.getRangeAt(0),n=document.createElement("br");t.deleteContents();t.insertNode(n);t.setStartAfter(n);t.setEndAfter(n);t.collapse(false);e.removeAllRanges();e.addRange(t)}});return false}}})};this.execute_listeners=function(){var e=document.querySelectorAll(".editor_executable");for(var t=0;t<e.length;t++){if(!editor.dataset(e[t],"click"))editor.add_event_listener({element:e[t],action:"click","do":function(e){editor.do_execution(e,this)}});editor.add_event_listener({element:e[t],action:"change","do":function(e){editor.do_execution(e,this)}})}};this.do_execution=function(e,t){if(e.preventDefault)e.preventDefault();else e.returnValue=false;var n=editor.dataset(t.element,"exec"),r=n in editor.exec?editor.exec[n]:{};r["do"]="do"in r?r["do"]:function(){};editor.temp_el=t.element;r["do"]();delete editor.temp_el;editor.get_breadcrumbs()};this.show_breadcrumbs=function(e){var t=[],n=e.reverse();n[0]="Editor";for(var r=0;r<e.length;r++)t.push(n[r]);this.breadcrumb_el.innerHTML=t.join(" / ");return t};this.document_exec=function(e){if(!e)e={};e["do"]="do"in e?e["do"]:"";e.options="options"in e?e.options:"";document.execCommand(e["do"],false,e.options)};this.add_tail=function(){this.editor_interact({action:["keyup","click"],"do":function(){if(editor.el.innerHTML.slice(-1)!=" "){editor.el.appendChild(document.createTextNode(" "))}}})};this.change_font_size=function(){this.with_selection({"do":function(e){if(e.rangeCount){var t=document.createElement("div");for(var n=0,r=e.rangeCount;n<r;++n){t.appendChild(e.getRangeAt(n).cloneContents())}var i=t.innerHTML.replace(/<(?!br\s*\/?)[^>]+>/g,"")}var s=e.getRangeAt(0).commonAncestorContainer;if(s===$(".editor_format-options")[0]){return}if(s.nodeType!==1&&s.parentNode!==editor.el){s.parentNode.parentNode.removeChild(s.parentNode)}var o=e.getRangeAt(0);o.deleteContents();if(editor.temp_el.value!=="normal"){var u=document.createElement("h"+editor.temp_el.value);u.setAttribute("class","body-header");u.innerHTML=i;if(i!==""){o.insertNode(u)}}else{node=o.createContextualFragment(i);o.insertNode(node)}}})};this.plain_paste=function(){editor.editor_interact({action:"paste","do":function(e){e.preventDefault();var t=rangy.getSelection(),n=(e.originalEvent||e).clipboardData.getData("text/plain"),r=document.createElement("span"),i=t.getRangeAt(0);r.innerHTML=editor.nl2br(n.replace(/\ /g,"&nbsp;").replace(/(<([^>]+)>)/ig,""));t.getRangeAt(0).deleteContents();node=i.createContextualFragment(r.innerHTML);t.getRangeAt(0).insertNode(node)}})};this.decode_html=function(e,t){var n=["&","<",">",'"'," "],r=["&","&lt;","&gt;","&quot;","&nbsp;"],i=[],s=[];if(t==="decode")i=r,s=n;else return e;for(var o=0;o<n.length;o++){var u=new RegExp(i[o],"g");e=e.replace(u,s[o])}return e};this.update_code=function(){this.editor_interact({action:["keyup","click"],"do":function(){if(editor.codemirror!==false){editor.codemirror.setValue(editor.decode_html(editor.br2nl(editor.el.innerHTML),"decode"))}}});this.editor_interact({element:editor.codemirror_el,action:["keyup","click"],"do":function(){editor.el.innerHTML=editor.decode_html(editor.codemirror.getValue(),"encode")}})};this.load_code=function(){if(editor.el)editor.code_el.value=editor.br2nl(editor.el.innerHTML)};this.toggle_code=function(){if(editor.codemirror===false){editor.codemirror=CodeMirror.fromTextArea(editor.code_el,{mode:"htmlmixed",lineNumbers:true,indentUnit:4,extraKeys:{Tab:function(e){var t=Array(e.getOption("indentUnit")+1).join(" ");e.replaceSelection(t);e.setCursor(e.getCursor())}},enableCodeFormatting:true});editor.codemirror_el=editor.codemirror.getWrapperElement();if(editor.codemirror_el)editor.codemirror_el.classList.add("editor_code-input")}if(editor.codemirror_el.classList.contains("editor_code-open")){editor.add_current(document.querySelectorAll(".editor_togglecode")[0],true);editor.codemirror_el.classList.remove("editor_code-open");editor.codemirror_el.style.display="none";editor.el.classList.remove("editor_fancy-closed");editor.el.innerHTML=editor.decode_html(editor.codemirror.getValue().replace(/\    /g,"").replace(/\  /g,"&nbsp;").replace(/<br>\n/g,"<br>"),"encode")}else{editor.add_current(document.querySelectorAll(".editor_togglecode")[0]);editor.codemirror_el.classList.add("editor_code-open");editor.codemirror_el.style.display="";editor.el.classList.add("editor_fancy-closed");editor.codemirror.setValue(editor.el.innerHTML.replace(/&nbsp;/g," ").replace(/<br\/>/g,"<br/>\n"));var e=editor.codemirror.lineCount();var t=editor.codemirror.getTextArea().value.length;editor.codemirror.autoFormatRange({line:0,ch:0},{line:e,ch:t});editor.codemirror.setCursor(0,0)}};this.add_code_block=function(){this.with_selection({"do":function(e){var t=document.createElement("code"),n=rangy.getSelection().getRangeAt(0);t.classList.add("prettyprint");t.innerHTML="<br>";n.deleteContents();n.insertNode(t);t.focus()}})};this.open_window=function(e){if(!e)e={};e.id="id"in e?e.id:"";e.header="header"in e?e.header:"";e.path="path"in e?e.path:"";e.after="after"in e?e.after:function(){};if(!document.getElementById(e.id))this.create_window(e)};this.create_window=function(e){if(!e)e={};e.id="id"in e?e.id:"some-window";e.header="header"in e?e.header:"Some Header";e.path="path"in e?e.path:"";e.before="before"in e?e.before:function(){};e.after="after"in e?e.after:function(){};e.buttons="buttons"in e?e.buttons:[];if(!document.getElementById(e.id)&&e.id!==""){el=document.createElement("div");el.setAttribute("id",e.id);el.setAttribute("class","editor_window window-open");el.style.visibility="hidden";var t=document.createElement("div");t.setAttribute("class","editor_window-header");t.innerHTML=e.header;var n=document.createElement("div");n.setAttribute("id","editor_wc-"+e.id);n.setAttribute("class","editor_window-content");var r=document.createElement("div");r.setAttribute("class","editor_window-submit");r.innerHTML=e.buttons.join("");e.before();el.appendChild(t);el.appendChild(n);el.appendChild(r);this.window_wrapper.appendChild(el);theamus.ajax.run({url:e.path,result:"editor_wc-"+e.id,type:"system",after:function(){editor.set_window_height(el,n);editor.center_window(el);e.after();document.body.style.overflow="hidden";el.style.visibility=""}})}};this.close_window=function(e){var t=this.parents(e,this.wrapper);for(var n=0;n<t.length;n++){if(t[n].classList.contains("editor_window"))var r=t[n]}document.body.style.overflow="";if(r)this.window_wrapper.removeChild(r)};this.set_window_height=function(e,t,n){if(n===undefined||n===null)n=0;if(e){var r=$(t).height();if(r!==n){e.style.height=120+r+"px";t.style.top="55px";$(".editor_window-submit").css("top",55+r);setTimeout(function(){editor.set_window_height(e,t,r)},200)}}else{setTimeout(function(){editor.set_window_height()},200)}};this.add_link_window=function(e){if(document.querySelectorAll(".editor_link")[0].getAttribute("disabled"))return;rangy.init();editor.with_selection({"do":function(e){var t=!e?"":e.toString(),n=["ltext="+t];editor.create_window({id:"new-link",header:"Add a Link",path:"editor/windows/link/?"+n.join("&"),before:editor.before_window,after:editor.after_link_window,buttons:["<input type='button' id='create_link' value='OK' />","<input type='button' name='cancel' id='close_window' value='Close' />"]})}})};this.create_link_element=function(e){if(editor.allow_new_link===false){editor.close_window(e);return false}var t=document.getElementById("weburl").value;if(editor.serialized!==false)rangy.deserializeSelection(editor.selection);editor.with_selection({"do":function(e){rangy.init();var t=document.getElementById("link-text").value,n=document.createTextNode(t);if(!e){editor.insert_at_caret(n)}else{var r=e.getRangeAt(0);e.getRangeAt(0).deleteContents();e.getRangeAt(0).insertNode(n)}var i=rangy.createRange();i.selectNodeContents(n);var s=rangy.getSelection();s.setSingleRange(i)}});editor.document_exec({"do":"unlink"});editor.document_exec({"do":"CreateLink",options:t});editor.close_window(e);editor.create_link_information()};this.link_information=function(){this.editor_interact({action:["mouseover","click"],"do":this.create_link_information})};this.create_link_information=function(){var e=editor.el.getElementsByTagName("a");for(var t=0;t<e.length;t++){var n=e[t],r=n.getAttribute("id"),i=Math.floor(Math.random()*99999);if(!r){n.setAttribute("id",i);var s=document.createElement("div");s.setAttribute("class","editor_link-info");s.setAttribute("data-id",i);s.innerHTML="<a target='_blank' href='"+n.href+"'>"+n.href+"</a>";s.innerHTML+="<a href='#' name='edit_link' data-id='"+i+"'>Edit</a>";s.innerHTML+="<a href='#' name='remove_link' data-id='"+i+"'>Remove</a>";editor.link_info_wrapper.appendChild(s);editor.on_info=true;editor.add_event_listener({element:n,action:"mouseover","do":function(e){var t=document.querySelectorAll(".editor_link-info");for(var n=0;n<t.length;n++){if(editor.dataset(t[n],"id")===this.element.getAttribute("id")){var r=this.element;t[n].style.position="absolute";t[n].style.top=editor.el.offsetTop+r.offsetTop+20+"px";t[n].style.left=editor.el.offsetLeft+r.offsetLeft-25+"px";t[n].classList.add("editor_link-info-open");editor.add_remove_listener();editor.add_edit_listener()}}}});editor.add_event_listener({element:n,action:"mouseout","do":function(){var e=document.querySelectorAll(".editor_link-info");for(var t=0;t<e.length;t++){if(editor.dataset(e[t],"id")===this.element.getAttribute("id")){e[t].classList.remove("editor_link-info-open")}}}})}}};this.add_remove_listener=function(){var e=document.getElementsByName("remove_link");for(var t=0;t<e.length;t++){if(editor.listeners.indexOf(e[t])===-1){editor.add_event_listener({element:e[t],action:"click","do":function(e){var t=this.element;editor.listeners.push(t);if(e.preventDefault)e.preventDefault();else e.returnValue=false;var n=document.getElementById(editor.dataset(t,"id"));var r=document.createRange();r.selectNodeContents(n);var i=rangy.getSelection();i.setSingleRange(r);editor.document_exec({"do":"unlink"});editor.link_info_wrapper.removeChild(t.parentNode)}})}}};this.add_edit_listener=function(){var e=document.getElementsByName("edit_link");for(var t=0;t<e.length;t++){if(editor.listeners.indexOf(e[t])===-1){editor.add_event_listener({element:e[t],action:"click","do":function(e){var t=this.element;editor.listeners.push(t);if(e.preventDefault)e.preventDefault();else e.returnValue=false;var n=rangy.createRange();n.selectNodeContents(document.getElementById(editor.dataset(t,"id")));var r=rangy.getSelection();r.setSingleRange(n);editor.with_selection({"do":function(e){var t=e.getRangeAt(0).commonAncestorContainer,n=t.href?t:t.parentNode,r=["ltext="+n.innerHTML,"lurl="+n.href];editor.create_window({id:"edit-link",header:"Edit Link",path:"editor/windows/link?"+r.join("&"),before:editor.before_window,after:editor.after_link_window,buttons:["<input type='button' id='create_link' value='OK' />","<input type='button' name='cancel' id='close_window' value='Close' />"]})}})}})}}};this.before_window=function(){editor.with_selection({"do":function(e){if(e!==false){var t=e.getRangeAt(0);editor.selection=rangy.serializeSelection(rangy.getSelection(),true);editor.serialized=true}else{var t=rangy.getSelection().getRangeAt(0);editor.range=rangy.serializeSelection(rangy.getSelection(),true);editor.serialized=false;editor.allow_new_link=true}var n=t.commonAncestorContainer;if(editor.parents(n).indexOf(editor.el)===-1&&n!==editor.el)editor.allow_new_link=false;else editor.allow_new_link=true}})};this.after_link_window=function(){var e=document.getElementsByName("link_type");for(var t=0;t<e.length;t++){var n=e[t];editor.add_event_listener({element:n,action:"click","do":function(e){if(e.preventDefault)e.preventDefault();else e.returnValue=false;document.getElementById("website-"+current).style.display="none";document.getElementById("website-"+editor.dataset(this,"type")).style.display=""}})}editor.add_event_listener({element:document.getElementById("create_link"),action:"click","do":function(e){if(e.preventDefault)e.preventDefault();else e.returnValue=false;editor.create_link_element(this.element)}});editor.add_event_listener({element:document.getElementById("close_window"),action:"click","do":function(e){editor.close_window(this.element)}})};this.add_img_tabs=function(){var e="<div class='image-window-tabs'><a href='#' name='image_type' data-for='url'>Add Image from URL</a><a href='#' name='image_type' data-for='lib'>Add Image from Library</a></div>";$("#editor_wc-add-image").prepend(e);for(var t=0;t<$("[name='image_type']").length;t++){editor.add_event_listener({element:$("[name='image_type']")[t],action:"click","do":function(e){e.preventDefault();var t=editor.dataset(this.element,"for"),n="";if(t==="url")n="editor/windows/add-image-link/";if(t==="lib")n="editor/windows/add-image/";$("#editor_wc-add-image").html(working());theamus.ajax.run({url:n,result:"editor_wc-add-image",type:"system",after:function(){editor.add_img_tabs();editor.set_window_height($(".editor_window")[0],$("#editor_wc-add-image")[0]);editor.center_window($(".editor_window")[0]);editor.add_img_listeners()}})}})}};this.add_image_window=function(){editor.create_window({id:"add-image",header:"Add an Image",path:"editor/windows/add-image",before:editor.before_window,after:function(){editor.center_after_imgload();editor.add_img_listeners();editor.add_img_tabs();editor.add_event_listener({element:document.getElementById("close_window"),action:"click","do":function(e){editor.close_window(this.element)}})},buttons:["<input type='button' name='cancel' id='close_window' value='Close' />"]})};this.center_after_imgload=function(){var e=document.getElementById("add-image");if(editor.check_imgload)editor.center_window(e);else setTimeout(editor.center_after_imgload,200)};this.check_imgload=function(){var e=document.getElementById("add-image");if(!e)return true;var t=e.getElementsByTagName("img"),n=[];for(var r=0;r<t.length;r++)n.push(t[r].complete);if(n.indexOf(false)===-1)return true;else setTimeout(editor.check_imgload,200)};this.images_next_page=function(e){theamus.ajax.run({url:"editor/windows/add-image&page="+e,result:"editor_window-content-add-image",type:"system",after:editor.add_img_listeners});return false};this.add_img_listeners=function(){var e=document.getElementsByName("add-image");for(var t=0;t<e.length;t++){editor.add_event_listener({element:e[t],action:"click","do":function(e){if(e.preventDefault)e.preventDefault();else e.returnValue=false;if(editor.allow_new_link===false)editor.close_window(this);editor.create_img(this);editor.close_window(this.element)}})}};this.create_img=function(e){var t=document.getElementById("width"),n=document.getElementById("height"),r=document.getElementById("alignment"),i=document.getElementById("image_path"),s=document.getElementById("image_type"),o=false,u="src";if(editor.serialized===true)rangy.deserializeSelection(editor.selection);editor.with_selection({"do":function(u){if(e!==undefined&&e.element!==undefined){if(editor.dataset(e.element,"type")!==null){var a=editor.dataset(e.element,"type"),f=document.createElement(a==="image"?"img":a),l=a==="object"?"data":"src"}else{o=true}if(editor.dataset(e.element,"path")!==null){f.setAttribute(l,editor.dataset(e.element,"path"))}else o=true}else{f=document.createElement(s.value);l=s.value!=="IMG"?"data":"src";if(i!==null)f.setAttribute(l,i.value);else o=true}if(o===false){if(t&&n&&r){f.style.height=n.value+"px";f.style.width=t.value+"px";f.setAttribute("align",r.value)}else{f.style.height="auto";f.style.maxWidth="200px"}if(!u)editor.insert_at_caret(f);else{var c=u.getRangeAt(0);u.getRangeAt(0).deleteContents();u.getRangeAt(0).insertNode(f)}var h=rangy.createRange();h.selectNodeContents(f);var p=rangy.getSelection();p.setSingleRange(h)}}})};this.edit_img_listeners=function(){editor.editor_interact({action:["mouseover","click"],"do":function(){var e=editor.el.getElementsByTagName("img"),t=editor.el.getElementsByTagName("object"),n=e.length===0?t:e;for(var r=0;r<n.length;r++){var i=n[r];if(editor.listeners.indexOf(i)===-1){editor.listeners.push(i);i.addEventListener("click",function(){var e=this.getAttribute("src").split("/"),t=e.indexOf("http:")===-1&&e.indexOf("https:")===-1?e[e.length-3]+"/"+e[e.length-2]+"/"+e[e.length-1]:this.getAttribute("src"),n=["path="+t.replace(/:/g,"{t:colon:}").replace(/\//g,"{t:bslash:}").replace(/\./g,"{t:period:}"),"width="+this.offsetWidth,"height="+this.offsetHeight,"align="+this.getAttribute("align"),"type="+this.tagName];var r=rangy.createRange();r.selectNode(this);var i=rangy.getSelection();i.setSingleRange(r);editor.image_size_ratio=Math.round(parseInt(this.offsetHeight)/parseInt(this.offsetWidth)*100)/100;editor.create_window({id:"add-image",header:"Edit Image",path:"editor/windows/edit-image&"+n.join("&"),before:editor.before_window,after:function(){editor.center_after_imgload();editor.add_event_listener({element:document.getElementsByName("update-image")[0],action:"click","do":function(){editor.create_img();editor.close_window(this)}});document.getElementById("height").addEventListener("keyup",function(){editor.constrain_image_demensions()});document.getElementById("constrain").addEventListener("change",function(){editor.toggle_disable("width")});document.getElementById("close_window").addEventListener("click",function(){editor.close_window(this)})},buttons:["<input type='button' name='update-image' value='Update Image' data-path='"+this.getAttribute("src")+"' />","<input type='button' name='cancel' id='close_window' value='Close' />"]})})}}}})};this.constrain_image_demensions=function(){if(document.getElementById("constrain").checked){var e=document.getElementById("height").value,t=Math.round(e*100/(this.image_size_ratio*100));document.getElementById("width").value=t}};this.add_current=function(e,t){if(!t)t=false;if(t===false&&!e.classList.contains("editor_current"))e.classList.add("editor_current");else if(t===true)e.classList.remove("editor_current")};this.toggle_sink=function(){var e=document.querySelectorAll(".editor_sink")[0];if(editor.sink.classList.contains("editor_sink-open")){editor.sink.classList.remove("editor_sink-open");editor.add_current(e,true)}else{editor.sink.classList.add("editor_sink-open");editor.add_current(e)}};this.set_current_formats=function(e,t){var n=document.querySelectorAll(".editor_executable"),r={bold:"b",underline:"u",italicize:"i",orderedlist:"ol",unorderedlist:"ul",addlink:"a",addcodeblock:"code"};for(var i=0;i<n.length;i++){var s=n[i],o=document.getElementById("editor_font-size"),u="";if(s===document.querySelectorAll(".editor_sink")[0])continue;if(e.indexOf(r[editor.dataset(n[i],"exec")])!==-1)editor.add_current(s);else editor.add_current(n[i],true);if(e.indexOf("a")>-1&&s.tagName!=="SELECT")s.setAttribute("disabled",true);else s.removeAttribute("disabled",true)}o.value="normal";for(var a=0;a<t.length;a++){if(t[a].tagName.toLowerCase()==="span"){if(t[a].style.fontSize){o.value=parseInt(t[a].style.fontSize)}}if(t[a].tagName.toLowerCase()==="div"){if(t[a].style.textAlign)u=t[a].style.textAlign}}var f=document.querySelectorAll(".editor_justify-"+u);if(f.length>0)editor.add_current(f[0])}}

// Theamus Main JS
function add_js_file(e){var t=e.split("?")[0];for(var n=0;n<$("script").length;n++){if($($("script")[n]).attr("src")===undefined)continue;var r=$($("script")[n]).attr("src").split("?")[0];if(r===t)$("script")[n].remove()}$("head").append("<script type='text/javascript' src='"+e+"'></script>")}function check_js_file(e){var t=new Array,n=e.split("?")[0];for(var r=0;r<$("script").length;r++){var i=$($("script")[r]);if(i.attr("src")===undefined)continue;var s=i.attr("src").split("?")[0];t.push(s===n?true:false)}return t.indexOf(true)===-1?true:false}function add_extras(){var e=$('[name="addscript"]');for(var t=0;t<e.length;t++){add_js_file(e[t].value);$(e[t]).remove()}var n=$("[name='addstyle']");for(var t=0;t<n.length;t++){add_css(n[t].value);$(n[t]).remove()}}function add_css(e){var t,n,r,i,s,o;t=$("base")[0].href;n=$("link");r=new Array;i=$("head")[0];s=e.split("?")[0];for(var u=0;u<n.length;u++){if(n[u].href!==""){r.push(n[u].href.split("?")[0])}}if(r.indexOf(t+e)===-1){if(r.indexOf(t+s)!==-1){var a=$("[href^='"+r[r.indexOf(t+s)].replace(t,"")+"']");for(var u=0;u<a.length;u++){$(a[u]).remove()}}$("head").append("<link rel='stylesheet' type='text/css' "+"href='"+e+"' />")}}function countdown(e,t,n){var r=document.getElementById("countdown");var i=document.getElementById("elipses");if(r.innerHTML===""){if(n===undefined||n===null){r.innerHTML=e+" "+t}else{r.innerHTML=e}}var t=t-1;timer=setInterval(function(){if(t>0){if(n===undefined||n===null){r.innerHTML=e+" "+t--}}else{clearInterval(countdownTimer);clearInterval(timer)}},1e3);countdownTimer=setInterval(function(){if(i.innerHTML===""){i.innerHTML="."}else if(i.innerHTML==="."){i.innerHTML=".."}else if(i.innerHTML===".."){i.innerHTML="..."}else if(i.innerHTML==="..."){i.innerHTML=""}},200)}function scroll_top(){window.scrollTo(0,0)}function admin_scroll_top(){$("#admin-content").animate({scrollTop:0},"slow")}function reload(e){if(e!==null&&e!==undefined){setTimeout(function(){window.location.reload()},e)}else{window.location.reload()}return false}function user_logout(){theamus.ajax.api({type:"post",url:theamus.base_url+"accounts/logout/",method:["Accounts","logout"],success:go_to});return false}function go_to(e){if(typeof e!=="string"){e=theamus.base_url}window.location=e}function go_back(){window.history.back()}function switch_notify(e,t){var n=document.getElementById("notify");n.className=e;n.innerHTML=t;n.innerHTML+="<span id='countdown'></span>";n.innerHTML+="<span id='elipses'></span>"}function insert_at_caret(e,t){if(document.selection){var n;e.focus();sel=document.selection.createRange();n=sel.text.length;sel.text=t;if(t.length==0){sel.moveStart("character",t.length);sel.moveEnd("character",t.length)}else{sel.moveStart("character",-t.length+n)}sel.select()}else if(e.selectionStart||e.selectionStart=="0"){var r=e.selectionStart;var i=e.selectionEnd;e.value=e.value.substring(0,r)+t+e.value.substring(i,e.value.length);e.selectionStart=r+t.length;e.selectionEnd=r+t.length}else{e.value+=t}}function working(){var e=$("#admin-content").hasClass("admin_content-wrapper-open")?"admin-notifyinfo":"site-notifyinfo";var t=$("<div class='"+e+"'></div>");t.append("<img src='themes/default/img/loading.gif' height='16px' align='left' />");t.append("<span style='margin-left:20px'>Working...</span>");return t}function notify(e,t,n){return"<div class='"+e+"-notify"+t+"'>"+n+"</div>"}function alert_notify(e,t){var n={success:"ion-checkmark-round",danger:"ion-close",warning:"ion-alert",info:"ion-information",spinner:"spinner spinner-fixed-size"};return"<div class='alert alert-"+e+"'><span class='glyphicon "+n[e]+"'></span>"+t+"</div>"}Theamus={Ajax:ajax,Editor:editor,base_url:document.getElementsByTagName("base")[0].href,Browser:function(){var e=navigator.userAgent,t,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([\d\.]+)/i)||[];if(/trident/i.test(n[1])){t=/\brv[ :]+(\d+(\.\d+)?)/g.exec(e)||[];return"IE "+(t[1]||"")}n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"];if((t=e.match(/version\/([\.\d]+)/i))!==null)n[2]=t[1];return n.join(" ")}(),Mobile:function(){var e=false;(function(t){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))e=true})(navigator.userAgent||navigator.vendor||window.opera);return e}(),Tablet:function(){return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase())}()}

// Theamus Theme
document.addEventListener('DOMContentLoaded', function(){$("#nav-response-btn").click(function(e){e.preventDefault();$($(this).data("open")).toggle()})})