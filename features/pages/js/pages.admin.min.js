function change_pages_tab(){$('[name="pages-tab"]').click(function(e){e.preventDefault();update_admin_window_content("theamus-pages",$(this).attr("data-file"));change_admin_window_title("theamus-pages",$(this).attr("data-title"))})}function get_pages(e){var t=e===undefined||e%1!==0?1:e,n=$("#pages-search-query").length>0?$("#pages-search-query").val():"";$("#pages_list").html(alert_notify("spinner","Loading..."));Theamus.Ajax.run({url:"pages/pages-list/&search="+n+"&page="+t,result:"pages-list",type:"include",after:function(){list_listeners()}});return false}function list_listeners(){$('[name="edit-page-link"]').click(function(e){e.preventDefault();change_admin_window_title("theamus-pages","Edit Page");update_admin_window_content("theamus-pages","pages/edit?id="+$(this).data("id"))});$('[name="remove-page-link"]').click(function(e){e.preventDefault();change_admin_window_title("theamus-pages","Remove Page");update_admin_window_content("theamus-pages","pages/remove?id="+$(this).data("id"))})}function search(){$("#pages-search-form").submit(function(e){e.preventDefault();get_pages(1)})}function add_new_link(){var e=$("#link-area").children().length+1,t="";if(e>1){t="<div class='form-control-static'>"+"<a href='#' data-link='"+e+"' name='remove-link'>Remove</a>"+"</div>"}var n="<div class='link_row' id='link_row"+e+"'>"+"<div class='form-group'>"+"<div class='col-12'>"+"<input type='text' class='form-control' autocomplete='off' placeholder='Link Text' id='linktext-"+e+"' />"+"<input type='text' class='form-control' autocomplete='off' placeholder='Link Path' id='linkpath-"+e+"' />"+"</div>"+"</div>"+t+"</div>";$("#link-area").append(n);return false}function aggregate_navigation(){var e=$("#link-area").children(),t=new Array,n;for(var r=1;r<=e.length;r++){if($("#linktext-"+r).val()!=="")t.push($("#linktext-"+r).val()+"::"+$("#linkpath-"+r).val())}n=t.join(",");$("#navigation").val(n);return}function remove_link(){$('[name="remove-link"]').click(function(e){e.preventDefault();$("#link_row"+$(this).attr("data-link")).remove()})}function load_layout_navigation(){var e=$("[name='layout']").children(),t=$("[name='layout']"),n=false;if(t.length>0)t=t[0].value;else return;for(var r=0;r<e.length;r++){if(e[r].value===t){if(e[r].dataset["nav"]==="true")n=true}}if(n===false){$("#nav-links").hide();$("#link-area").html("");$("#navigation")[0].value}else{$("#nav-links").show();if($("#link-area").children().length===0){add_new_link()}}}function create_page(){$('[name="layout"]').change(function(){load_layout_navigation()});$("#add-new-link").click(function(e){e.preventDefault();add_new_link();remove_link()});$("#create-page-form").submit(function(e){e.preventDefault();aggregate_navigation();$("#page-result").html(Theamus.Notify("spinner","Creating..."));$("#theamus-pages").scrollTop(0);$(this).find('button[type="submit"]').attr("disabled","disabled");Theamus.Ajax.api({type:"post",url:Theamus.base_url+"/pages/",method:["Pages","create_page"],data:{form:this},success:function(e){if(e.error.status===1){$("#page-result").html(Theamus.Notify("danger",e.error.message));$("#create-page-form").find('button[type="submit"]').removeAttr("disabled")}else{$("#page-result").html(Theamus.Notify("success","Page created successfully."));setTimeout(function(){update_admin_window_content("theamus-pages","pages/");change_admin_window_title("theamus-pages","Theamus Pages")},1500)}}})})}function edit_page(){$('[name="layout"]').change(function(){load_layout_navigation()});$("#add-new-link").click(function(e){e.preventDefault();add_new_link();remove_link()});$("#save-page-form").submit(function(e){e.preventDefault();aggregate_navigation();$("#page-result").html(Theamus.Notify("spinner","Saving..."));$("#theamus-pages").scrollTop(0);$(this).find('button[type="submit"]').attr("disabled","disabled");Theamus.Ajax.api({type:"post",url:Theamus.base_url+"/pages/",method:["Pages","save_page"],data:{form:this},success:function(e){$("#page-result").show();if(e.error.status===1){$("#page-result").html(Theamus.Notify("danger",e.error.message))}else{$("#page-result").html(Theamus.Notify("success","Page saved."));setTimeout(function(){$("#page-result").html("").hide()},2e3)}$("#save-page-form").find('button[type="submit"]').removeAttr("disabled")}})})}function remove_page(){$("#remove-page-form").submit(function(e){e.preventDefault();$("#remove-result").html(Theamus.Notify("spinner","Removing..."));$(this).find('button[type="submit"]').attr("disabled","disabled");Theamus.Ajax.api({type:"post",url:Theamus.base_url+"/pages/",method:["Pages","remove_page"],data:{form:this},success:function(e){if(e.error.status===1){$("#remove-result").html(Theamus.Notify("danger",e.error.message))}else{$("#remove-result").html(Theamus.Notify("success","Page removed."));setTimeout(function(){update_admin_window_content("theamus-pages","pages/");change_admin_window_title("theamus-pages","Theamus Pages")},1500)}}})})}